/opt/anaconda3/envs/kafal_env/lib/python3.9/site-packages/torch/nn/_reduction.py:51: UserWarning: size_average and reduce args will be deprecated, please use reduction='none' instead.
  warnings.warn(warning.format(ret))
Using device: mps
base number:  [101  92 101 101 112 117 104 104  91  83]
budget each round:  [31 28 31 31 34 35 32 32 28 25]
client 0, ratio [0.08305119 0.02688707 0.         0.         0.         0.02310297
 0.         0.7472615  0.10914161 0.01055567]
client 1, ratio [0.         0.08428446 0.00417032 0.         0.06057946 0.
 0.61391572 0.         0.         0.23705004]
client 2, ratio [0.0245607  0.         0.05950479 0.         0.54872204 0.0009984
 0.36621406 0.         0.         0.        ]
client 3, ratio [0.05644196 0.         0.         0.02074192 0.21798963 0.04826486
 0.         0.00159553 0.45891504 0.19605106]
client 4, ratio [0.00000000e+00 3.05480683e-03 4.41689128e-01 6.55884996e-02
 0.00000000e+00 1.79694519e-04 0.00000000e+00 1.03144654e-01
 3.86343217e-01 0.00000000e+00]
client 5, ratio [0.         0.         0.26295915 0.         0.         0.73704085
 0.         0.         0.         0.        ]
client 6, ratio [0.77554568 0.06644775 0.05060846 0.         0.02897431 0.01757775
 0.06084605 0.         0.         0.        ]
client 7, ratio [0.00000000e+00 0.00000000e+00 0.00000000e+00 8.73505592e-01
 1.15696105e-03 3.85653683e-04 0.00000000e+00 1.24951793e-01
 0.00000000e+00 0.00000000e+00]
client 8, ratio [0.03272888 0.91088014 0.         0.         0.         0.05484299
 0.00154799 0.         0.         0.        ]
client 9, ratio [3.39393939e-03 2.42424242e-04 1.04484848e-01 2.42424242e-04
 1.76242424e-01 2.42424242e-04 1.13939394e-02 4.36363636e-03
 2.42424242e-04 6.99151515e-01]
>> Train a Model.
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:25<00:00, 25.52s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.33s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.76s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:25<00:00, 25.46s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.60s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.21s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.66s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.60s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.26s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.17s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.23s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.16s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.17s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.27s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.14s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.18s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.20s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.11s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.18s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.26s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [15:40<00:00, 940.69s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                              Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.26s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.93s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.85s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.83s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.41s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.73s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.53s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.64s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.93s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.25s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.49s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.73s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.22s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.41s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.75s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:25<00:00, 25.14s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.53s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.88s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.23s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.23s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.26s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.48s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.85s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.63s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.12s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.67s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.65s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.80s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.46s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.45s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.40s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.48s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.98s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.86s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.29s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.76s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.34s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.39s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.36s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.21s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.51s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.31s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.81s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.47s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.50s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.42s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.41s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.39s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.42s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.46s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.67s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.49s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.32s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.36s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.49s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.28s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.37s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.29s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.20s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.26s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.28s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.39s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.22s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.35s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.28s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.38s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.39s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.19s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.28s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.33s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.36s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.34s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.51s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.24s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.36s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.16s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.23s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.33s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.23s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.30s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.26s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.26s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.48s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.37s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.32s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.33s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.38s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.29s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:25<00:00, 25.12s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.51s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.44s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.57s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.22s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.29s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.29s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.24s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.27s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.34s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.32s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.21s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.30s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.14s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.32s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.32s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.28s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.22s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.23s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.17s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.43s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.26s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.45s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.32s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.16s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.57s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.30s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.29s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.47s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.30s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.57s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.23s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.34s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.40s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.22s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.24s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.24s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [16:38<00:00, 998.52s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                              Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [09:53<00:00, 593.74s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                              Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.85s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.27s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.44s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.25s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.27s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.10s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.40s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.42s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.31s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.18s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.47s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:24<00:00, 24.41s/it]Using device: mps
Using device: mps
Using device: mps
Using device: mps
                                             Using device: mps
Using device: mps
Using device: mps
Using device: mps
time epoch: 472.44132034778596
epoch number: 19
Traceback (most recent call last):
  File "/Users/davidjin/Projects/FedAL/main.py", line 366, in <module>
    train(models, criterion, optimizers, schedulers, dataloaders, EPOCH)
  File "/Users/davidjin/Projects/FedAL/main.py", line 220, in train
    model_state[key] /= np.sum(selected_data_num)
RuntimeError: result type Float can't be cast to the desired output type Long
